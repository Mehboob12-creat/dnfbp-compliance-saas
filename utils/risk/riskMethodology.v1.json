{
  "methodology": {
    "name": "DNFBP AML/CFT Risk Methodology",
    "version": "v1.0",
    "jurisdiction": "Pakistan",
    "effective_from": "2026-01-20",
    "notes_inspection_safe": [
      "This configuration supports an evidence-based, risk-based approach (RBA).",
      "Outputs are workflow indicators for internal review and do not constitute automatic regulatory reporting or filing.",
      "Historical case outputs should retain the config snapshot/version used at time of generation."
    ]
  },
  "scoring": {
    "score_range": { "min": 0, "max": 100 },
    "risk_rating_bands": [
      { "min": 0, "max": 20, "label": "Low" },
      { "min": 21, "max": 40, "label": "Medium" },
      { "min": 41, "max": 70, "label": "High" },
      { "min": 71, "max": 100, "label": "Very High" }
    ],
    "overrides_auto_very_high": [
      {
        "key": "OVR_PEP_RCA",
        "when": { "any": [{ "field": "pep_status", "in": ["PEP", "FAMILY_MEMBER", "CLOSE_ASSOCIATE"] }] },
        "risk_rating": "Very High",
        "reason_text": "PEP / family member / close associate identified."
      },
      {
        "key": "OVR_UNRESOLVED_TFS_MATCH",
        "when": {
          "any": [
            {
              "field": "screening.overall_status",
              "in": ["MATCH_CLEARANCE_PENDING", "CONFIRMED_MATCH_NOT_CLEARED"]
            }
          ]
        },
        "risk_rating": "Very High",
        "reason_text": "Sanctions/TFS screening match not cleared as false positive."
      },
      {
        "key": "OVR_NO_CLEAR_BO",
        "when": { "any": [{ "field": "beneficial_ownership_status", "eq": "NO_CLEAR_BO" }] },
        "risk_rating": "Very High",
        "reason_text": "No clear beneficial owner identified (legal person)."
      },
      {
        "key": "OVR_CDD_INCOMPLETE_DOCS",
        "when": {
          "any": [
            { "field": "hard_documents_submitted", "eq": "NO" },
            { "field": "cdd_complete", "eq": false }
          ]
        },
        "risk_rating": "Very High",
        "reason_text": "CDD incomplete due to non-submission of mandatory documents."
      },
      {
        "key": "OVR_CONFIRMED_TF_LINKAGE",
        "when": { "any": [{ "field": "manual_tf_linkage_confirmed", "eq": true }] },
        "risk_rating": "Very High",
        "reason_text": "Manual flag: confirmed terrorist financing linkage (requires evidence and human approval)."
      }
    ]
  },
  "reference_lists": {
    "pakistan_geography": {
      "high_risk_districts": [
        "Bajaur",
        "Mohmand",
        "Khyber",
        "Kurram",
        "Orakzai",
        "North Waziristan",
        "South Waziristan",
        "Chaman",
        "Nushki",
        "Panjgur",
        "Washuk",
        "Kech (Turbat)",
        "Gwadar",
        "Bahawalpur",
        "Rahim Yar Khan",
        "Bahawalnagar",
        "Dera Ghazi Khan",
        "Rajanpur",
        "Muzaffargarh",
        "Layyah",
        "Bhakkar"
      ],
      "major_city_risk": ["Karachi", "Quetta", "Peshawar"]
    },
    "foreign_exposure": {
      "high_risk_countries_examples": ["Iran", "Afghanistan", "DPRK", "Myanmar", "Syria"],
      "note": "Country lists can be managed as reference data in DB later; examples shown here."
    }
  },
  "natural_person": {
    "fields": {
      "acting_capacity": {
        "type": "enum",
        "options": ["SELF", "ON_BEHALF"],
        "points": { "SELF": 0, "ON_BEHALF": 15 },
        "reasons": {
          "ON_BEHALF": "Acting on behalf of another person."
        }
      },
      "occupation": {
        "type": "enum",
        "options": ["SALARIED_PROFESSIONAL", "BUSINESS_SELF_EMPLOYED", "UNEMPLOYED_OTHER", "POLITICIAN_PUBLIC_OFFICE"],
        "points": {
          "SALARIED_PROFESSIONAL": 0,
          "BUSINESS_SELF_EMPLOYED": 5,
          "UNEMPLOYED_OTHER": 10
        },
        "override_if": {
          "POLITICIAN_PUBLIC_OFFICE": {
            "override_key": "OVR_PEP_RCA",
            "reason_text": "Occupation indicates public office holder; treat as PEP category for override handling."
          }
        },
        "reasons": {
          "BUSINESS_SELF_EMPLOYED": "Occupation: business owner / self-employed.",
          "UNEMPLOYED_OTHER": "Occupation: unemployed / other."
        }
      },
      "industry_sector": {
        "type": "enum",
        "options": ["MANUFACTURING_SERVICES", "IMPORT_EXPORT", "REAL_ESTATE_DPMS_CASH_INTENSIVE"],
        "points": {
          "MANUFACTURING_SERVICES": 0,
          "IMPORT_EXPORT": 5,
          "REAL_ESTATE_DPMS_CASH_INTENSIVE": 10
        },
        "reasons": {
          "IMPORT_EXPORT": "Sector: import/export.",
          "REAL_ESTATE_DPMS_CASH_INTENSIVE": "Sector: real estate / DPMS / cash-intensive."
        }
      },
      "source_of_funds": {
        "type": "enum",
        "options": ["SALARY_BUSINESS", "SALE_ASSET_INHERITANCE_BANK_LOAN", "PRIVATE_LOAN", "GIFT_OTHER"],
        "points": {
          "SALARY_BUSINESS": 0,
          "SALE_ASSET_INHERITANCE_BANK_LOAN": 5,
          "PRIVATE_LOAN": 10,
          "GIFT_OTHER": 15
        },
        "reasons": {
          "SALE_ASSET_INHERITANCE_BANK_LOAN": "Source of funds: sale of asset / inheritance / bank loan.",
          "PRIVATE_LOAN": "Source of funds: private loan.",
          "GIFT_OTHER": "Source of funds: gift / other."
        }
      },
      "declared_income_band_fbr": {
        "type": "enum",
        "options": [
          "ABOVE_10M",
          "5M_TO_10M",
          "3M_TO_5M",
          "1M_TO_3M",
          "BELOW_1M",
          "NON_FILER"
        ],
        "points": {
          "ABOVE_10M": 0,
          "5M_TO_10M": 3,
          "3M_TO_5M": 5,
          "1M_TO_3M": 8,
          "BELOW_1M": 12,
          "NON_FILER": 20
        },
        "lower_bound_pkr": {
          "ABOVE_10M": 10000000,
          "5M_TO_10M": 5000000,
          "3M_TO_5M": 3000000,
          "1M_TO_3M": 1000000,
          "BELOW_1M": 0,
          "NON_FILER": 0
        },
        "reasons": {
          "5M_TO_10M": "Declared income (FBR): PKR 5–10 million.",
          "3M_TO_5M": "Declared income (FBR): PKR 3–5 million.",
          "1M_TO_3M": "Declared income (FBR): PKR 1–3 million.",
          "BELOW_1M": "Declared income (FBR): below PKR 1 million.",
          "NON_FILER": "FBR status: non-filer."
        }
      },
      "txn_vs_income_mismatch": {
        "type": "computed",
        "inputs": ["transaction_amount_pkr", "declared_income_band_fbr"],
        "rule": "Compare transaction_amount_pkr against the lower bound of the selected income band. If NON_FILER, apply +20 for any transaction.",
        "points_by_ratio": [
          { "max_ratio_inclusive": 1.0, "points": 0, "reason_text": "Transaction amount is within declared income (≤ 1×)." },
          { "min_ratio_exclusive": 1.0, "max_ratio_inclusive": 3.0, "points": 5, "reason_text": "Transaction amount exceeds declared income (> 1× to ≤ 3×)." },
          { "min_ratio_exclusive": 3.0, "max_ratio_inclusive": 5.0, "points": 10, "reason_text": "Transaction amount exceeds declared income (> 3× to ≤ 5×)." },
          { "min_ratio_exclusive": 5.0, "points": 20, "reason_text": "Transaction amount exceeds declared income (> 5×)." }
        ],
        "non_filer_points": 20,
        "non_filer_reason_text": "Non-filer with a recorded transaction."
      },
      "payment_mode": {
        "type": "enum",
        "options": ["BANK_TRANSFER", "CHEQUE", "MIXED", "CASH"],
        "points": { "BANK_TRANSFER": 0, "CHEQUE": 0, "MIXED": 5, "CASH": 15 },
        "reasons": {
          "MIXED": "Payment mode: mixed.",
          "CASH": "Payment mode: cash."
        }
      },
      "pakistan_geography": {
        "type": "geo_lookup",
        "inputs": ["pakistan_location_label"],
        "points": { "HIGH_RISK_DISTRICT": 12, "MAJOR_CITY": 8, "OTHER": 0 },
        "reasons": {
          "HIGH_RISK_DISTRICT": "Pakistan geography: high-risk district.",
          "MAJOR_CITY": "Pakistan geography: major city risk tag (Karachi/Quetta/Peshawar)."
        }
      },
      "foreign_exposure": {
        "type": "enum",
        "options": ["NONE", "LOW_RISK", "HIGH_RISK"],
        "points": { "NONE": 0, "LOW_RISK": 5, "HIGH_RISK": 10 },
        "reasons": {
          "LOW_RISK": "Foreign exposure: low-risk country.",
          "HIGH_RISK": "Foreign exposure: high-risk country."
        }
      },
      "pep_status": {
        "type": "enum",
        "options": ["NOT_PEP", "PEP", "FAMILY_MEMBER", "CLOSE_ASSOCIATE"],
        "points": { "NOT_PEP": 0 },
        "override_if": {
          "PEP": { "override_key": "OVR_PEP_RCA" },
          "FAMILY_MEMBER": { "override_key": "OVR_PEP_RCA" },
          "CLOSE_ASSOCIATE": { "override_key": "OVR_PEP_RCA" }
        }
      }
    }
  },
  "legal_person": {
    "fields": {
      "entity_type": {
        "type": "enum",
        "options": [
          "PRIVATE_LIMITED",
          "PUBLIC_LIMITED",
          "GOVERNMENT",
          "PARTNERSHIP",
          "LLP",
          "SOLE_PROPRIETORSHIP",
          "TRUST",
          "NGO",
          "WAQF"
        ],
        "points": {
          "PRIVATE_LIMITED": 0,
          "PUBLIC_LIMITED": 0,
          "GOVERNMENT": 0,
          "PARTNERSHIP": 5,
          "LLP": 5,
          "SOLE_PROPRIETORSHIP": 5,
          "TRUST": 15,
          "NGO": 15,
          "WAQF": 15
        },
        "reasons": {
          "PARTNERSHIP": "Entity type: partnership / LLP / sole proprietorship.",
          "LLP": "Entity type: partnership / LLP / sole proprietorship.",
          "SOLE_PROPRIETORSHIP": "Entity type: partnership / LLP / sole proprietorship.",
          "TRUST": "Entity type: trust / NGO / waqf.",
          "NGO": "Entity type: trust / NGO / waqf.",
          "WAQF": "Entity type: trust / NGO / waqf."
        }
      },
      "country_of_incorporation_risk": {
        "type": "enum",
        "options": ["PAKISTAN", "FOREIGN_LOW_RISK", "FOREIGN_HIGH_RISK"],
        "points": { "PAKISTAN": 0, "FOREIGN_LOW_RISK": 5, "FOREIGN_HIGH_RISK": 10 },
        "reasons": {
          "FOREIGN_LOW_RISK": "Country of incorporation: foreign (low risk).",
          "FOREIGN_HIGH_RISK": "Country of incorporation: foreign (high risk)."
        }
      },
      "pakistan_geography": {
        "type": "geo_lookup",
        "inputs": ["pakistan_location_label"],
        "points": { "HIGH_RISK_DISTRICT": 12, "MAJOR_CITY": 8, "OTHER": 0 },
        "reasons": {
          "HIGH_RISK_DISTRICT": "Pakistan geography: high-risk district.",
          "MAJOR_CITY": "Pakistan geography: major city risk tag (Karachi/Quetta/Peshawar)."
        }
      },
      "business_sector": {
        "type": "enum",
        "options": ["MANUFACTURING_SERVICES", "IMPORT_EXPORT", "REAL_ESTATE_DPMS_CASH_INTENSIVE_NGO"],
        "points": { "MANUFACTURING_SERVICES": 0, "IMPORT_EXPORT": 5, "REAL_ESTATE_DPMS_CASH_INTENSIVE_NGO": 15 },
        "reasons": {
          "IMPORT_EXPORT": "Business sector: import/export.",
          "REAL_ESTATE_DPMS_CASH_INTENSIVE_NGO": "Business sector: real estate / DPMS / cash-intensive / NGO."
        }
      },
      "ownership_structure": {
        "type": "enum",
        "options": ["SIMPLE", "MODERATE", "COMPLEX_LAYERED_NOMINEE"],
        "points": { "SIMPLE": 0, "MODERATE": 5, "COMPLEX_LAYERED_NOMINEE": 15 },
        "reasons": {
          "MODERATE": "Ownership structure: moderate.",
          "COMPLEX_LAYERED_NOMINEE": "Ownership structure: complex / layered / nominee."
        }
      },
      "beneficial_ownership_status": {
        "type": "enum",
        "options": ["DIRECT_BO", "INDIRECT_BO", "NO_CLEAR_BO"],
        "points": { "DIRECT_BO": 0, "INDIRECT_BO": 10 },
        "override_if": {
          "NO_CLEAR_BO": { "override_key": "OVR_NO_CLEAR_BO" }
        },
        "reasons": {
          "INDIRECT_BO": "Beneficial ownership: indirect."
        }
      },
      "ubo_country_risk": {
        "type": "enum",
        "options": ["PAKISTAN", "FOREIGN_LOW_RISK", "FOREIGN_HIGH_RISK"],
        "points": { "PAKISTAN": 0, "FOREIGN_LOW_RISK": 5, "FOREIGN_HIGH_RISK": 10 },
        "reasons": {
          "FOREIGN_LOW_RISK": "UBO country risk: foreign (low risk).",
          "FOREIGN_HIGH_RISK": "UBO country risk: foreign (high risk)."
        }
      },
      "control_type": {
        "type": "enum",
        "options": ["OWNERS_BOARD", "TRUSTEE_SETTLOR", "NOMINEE_POA"],
        "points": { "OWNERS_BOARD": 0, "TRUSTEE_SETTLOR": 5, "NOMINEE_POA": 10 },
        "reasons": {
          "TRUSTEE_SETTLOR": "Control type: trustee/settlor.",
          "NOMINEE_POA": "Control type: nominee/POA."
        }
      },
      "declared_turnover_band_fbr": {
        "type": "enum",
        "options": [
          "ABOVE_100M",
          "50M_TO_100M",
          "10M_TO_50M",
          "5M_TO_10M",
          "BELOW_5M",
          "NON_FILER"
        ],
        "points": {
          "ABOVE_100M": 0,
          "50M_TO_100M": 3,
          "10M_TO_50M": 5,
          "5M_TO_10M": 8,
          "BELOW_5M": 12,
          "NON_FILER": 15
        },
        "lower_bound_pkr": {
          "ABOVE_100M": 100000000,
          "50M_TO_100M": 50000000,
          "10M_TO_50M": 10000000,
          "5M_TO_10M": 5000000,
          "BELOW_5M": 0,
          "NON_FILER": 0
        },
        "reasons": {
          "50M_TO_100M": "Declared turnover (FBR): PKR 50–100 million.",
          "10M_TO_50M": "Declared turnover (FBR): PKR 10–50 million.",
          "5M_TO_10M": "Declared turnover (FBR): PKR 5–10 million.",
          "BELOW_5M": "Declared turnover (FBR): below PKR 5 million.",
          "NON_FILER": "FBR status: non-filer."
        }
      },
      "txn_vs_turnover_mismatch": {
        "type": "computed",
        "inputs": ["transaction_amount_pkr", "declared_turnover_band_fbr"],
        "rule": "Compare transaction_amount_pkr against the lower bound of the selected turnover band. Compute ratio = txn / turnover_lower_bound. If turnover lower bound is 0 and not NON_FILER, treat mismatch as highest tier.",
        "points_by_ratio": [
          { "max_ratio_inclusive": 0.10, "points": 0, "reason_text": "Transaction amount is within 10% of declared turnover (≤ 10%)." },
          { "min_ratio_exclusive": 0.10, "max_ratio_inclusive": 0.30, "points": 5, "reason_text": "Transaction amount exceeds 10%–30% of declared turnover." },
          { "min_ratio_exclusive": 0.30, "max_ratio_inclusive": 0.50, "points": 10, "reason_text": "Transaction amount exceeds 30%–50% of declared turnover." },
          { "min_ratio_exclusive": 0.50, "max_ratio_inclusive": 1.0, "points": 15, "reason_text": "Transaction amount exceeds 50%–100% of declared turnover." },
          { "min_ratio_exclusive": 1.0, "points": 20, "reason_text": "Transaction amount exceeds 100% of declared turnover (> 100%)." }
        ],
        "non_filer_points": 20,
        "non_filer_reason_text": "Non-filer with a recorded transaction."
      },
      "hard_documents_submitted": {
        "type": "enum",
        "options": ["YES", "NO"],
        "points": { "YES": 0 },
        "override_if": {
          "NO": { "override_key": "OVR_CDD_INCOMPLETE_DOCS" }
        },
        "reasons": {
          "NO": "Mandatory documents not submitted."
        }
      }
    }
  },
  "recommendations": {
    "edd_required_if_any": [
      { "field": "risk_rating", "in": ["High", "Very High"] },
      { "field": "pep_status", "in": ["PEP", "FAMILY_MEMBER", "CLOSE_ASSOCIATE"] },
      { "field": "pakistan_geography_tag", "eq": "HIGH_RISK_DISTRICT" },
      { "field": "foreign_exposure", "eq": "HIGH_RISK" },
      { "field": "mismatch_points", "gte": 10 },
      { "field": "acting_capacity", "eq": "ON_BEHALF" },
      { "field": "ownership_structure", "eq": "COMPLEX_LAYERED_NOMINEE" },
      { "field": "beneficial_ownership_status", "eq": "INDIRECT_BO" },
      { "field": "hard_documents_submitted", "eq": "NO" }
    ],
    "ctr_applicable": {
      "when_all": [
        { "field": "payment_mode", "eq": "CASH" },
        { "field": "transaction_amount_pkr", "gte": 2000000 }
      ],
      "reason_text": "Cash transaction equals or exceeds the CTR applicability threshold (PKR 2,000,000)."
    },
    "str_review_recommended_if_any": [
      { "field": "risk_rating", "eq": "Very High" },
      { "field": "screening.overall_status", "in": ["MATCH_CLEARANCE_PENDING", "CONFIRMED_MATCH_NOT_CLEARED"] },
      { "field": "declared_income_band_fbr", "eq": "NON_FILER" },
      { "field": "declared_turnover_band_fbr", "eq": "NON_FILER" },
      { "field": "mismatch_points", "eq": 20 },
      { "field": "beneficial_ownership_status", "eq": "NO_CLEAR_BO" },
      {
        "when_all": [
          { "field": "pakistan_geography_tag", "eq": "HIGH_RISK_DISTRICT" },
          { "field": "payment_mode", "eq": "CASH" },
          { "field": "mismatch_points", "gte": 10 }
        ],
        "reason_text": "High-risk geography with cash payment and material mismatch."
      },
      {
        "when_all": [
          { "field": "hard_documents_submitted", "eq": "NO" },
          { "field": "transaction_amount_pkr", "gte": 1 }
        ],
        "reason_text": "CDD incomplete with a recorded transaction."
      }
    ],
    "report_display_labels": {
      "risk_label_only": true,
      "str_label": "STR review recommended",
      "ctr_label": "CTR applicable",
      "edd_label": "EDD required",
      "notes": [
        "Recommendations support internal review; reporting/filing decisions remain subject to compliance officer approval."
      ]
    }
  },
  "controls": {
    "co_acceptance_blockers": [
      {
        "key": "BLK_DOCS_NOT_SUBMITTED",
        "when": { "any": [{ "field": "hard_documents_submitted", "eq": "NO" }] },
        "blocked_decisions": ["ACCEPTED"],
        "message": "Acceptance is not available because mandatory documents were not submitted."
      },
      {
        "key": "BLK_TFS_MATCH_UNCLEARED",
        "when": {
          "any": [
            {
              "field": "screening.overall_status",
              "in": ["MATCH_CLEARANCE_PENDING", "CONFIRMED_MATCH_NOT_CLEARED"]
            }
          ]
        },
        "blocked_decisions": ["ACCEPTED"],
        "message": "Acceptance is not available because screening results are pending review/clearance."
      },
      {
        "key": "BLK_NO_CLEAR_BO",
        "when": { "any": [{ "field": "beneficial_ownership_status", "eq": "NO_CLEAR_BO" }] },
        "blocked_decisions": ["ACCEPTED"],
        "message": "Acceptance is not available because no clear beneficial owner has been identified."
      }
    ],
    "audit_requirements": [
      "Record who generated the case and when.",
      "Record screening run timestamp and list versions/evidence references.",
      "Record risk reasons and any overrides applied.",
      "Record recommendation reasons (EDD/CTR/STR review)."
    ]
  }
}
